# GNSS Positioning Coursework Assets

This repository collects all data products and scripts used to study single point positioning (SPP) and differential GNSS (DGNSS) solutions for the **aae4203** coursework. It combines the raw rover log, reference-station RINEX files, MATLAB tooling based on MatRTKLIB, and a Python implementation of a weighted least-squares position solver with visualisation utilities.

## Repository layout

| Path | Description |
| --- | --- |
| `RAW Data/` | Original rover log (`blockx.ubx`) recorded with a u-blox receiver. |
| `Base Station Observation Data/` | HKSC reference-station RINEX observation files (`.25*`) used for differential processing. |
| `MatRTKLIB/` | Git submodule that wraps the RTKLIB/MALIB GNSS library for MATLAB. Provides GNSS utilities (`+gt/`), MATLAB bindings (`+rtklib/`), documentation, and examples. |
| `matlab/rinex2csv.m` | MATLAB script that drives MatRTKLIB to read the `rinex_data` RINEX files, perform an SPP solution, and export epoch-by-epoch measurements and corrections as CSV matrices for Python post-processing. |
| `rinex_data/` | CSVs exported from MATLAB: pseudoranges, satellite clock bias, ionospheric/tropospheric delay estimates, and satellite ECEF positions. Also includes the RINEX navigation/observation files (`blockx.nav`, `blockx.obs`). |
| `ubx-message/` | Tools and samples for decoding the raw UBX log. The `pyubx2_csv_converter_gui.py` tkinter app converts a `.ubx` file into per-message CSV files (stored under `ubx-message/data/`). |
| `wls-spp/gnss_position_estimator.py` | Standalone Python implementation of a weighted least-squares SPP solver with DOP/error analytics, plotting, and optional truth comparison from NAV-HPPOSECEF logs. |
| `SPP/` and `DGNSS/` | RTKLIB solution outputs (`.pos`, `.pos.stat`, `.kml`) for the standalone and differential positioning runs. |
| `Result/` | Products generated by the Python SPP pipeline: the per-epoch solution (`lse_solution.csv`), plots, statistics summaries, and a Google Earth KML track. |

## Data-processing pipeline

The expected workflow for recreating the positioning results is:

1. **Decode the UBX rover log.** Use `python ubx-message/pyubx2_csv_converter_gui.py` to launch the GUI, point it at `RAW Data/blockx.ubx`, and export the individual message CSVs into `ubx-message/data/`. This step provides truth data such as `NAV-HPPOSECEF.csv` for evaluation.
2. **Generate measurement matrices in MATLAB.** Open MATLAB, add MatRTKLIB to the path (`addpath('MatRTKLIB')`), and run `matlab/rinex2csv.m`. The script reads the rover `rinex_data/blockx.obs` and broadcast ephemeris `rinex_data/blockx.nav`, applies elevation/SNR masking, solves for the rover state, and writes measurement/correction matrices into `rinex_data/*.csv` for every epoch.
3. **Solve SPP in Python.** Edit the file paths at the top of `main()` inside `wls-spp/gnss_position_estimator.py` so they point to your local copies of the CSV inputs and desired outputs. Running `python wls-spp/gnss_position_estimator.py` consumes the MATLAB exports, performs an iterative least-squares position estimate per epoch (with optional Earth-rotation correction), computes DOP metrics, compares against the truth trajectory when available, emits summary CSVs, and saves diagnostic plots/KMLs in `Result/`.
4. **Review RTKLIB baselines.** The `SPP/` and `DGNSS/` folders contain the original RTKLIB solution files for reference. Comparing these with the Python `Result/` outputs helps validate the reimplementation.

## Python environment

The Python solver uses only widely available scientific libraries. Install them in your environment before running the script:

```bash
python -m pip install numpy pandas matplotlib
```

The solver exposes several reusable helpers (coordinate transforms, DOP computation, ENU error statistics, KML export). You can import `gnss_position_estimator` as a module and call `solve_epoch_ls`, `compute_error_statistics`, or `generate_and_save_plots` directly when experimenting in notebooks.

## MATLAB and MatRTKLIB notes

MatRTKLIB is checked in as a submodule. If you cloned this repository yourself, initialise it via:

```bash
git submodule update --init --recursive
```

Refer to `MatRTKLIB/README.md` for platform-specific compilation instructions and a catalogue of built-in examples. The provided `matlab/rinex2csv.m` script demonstrates how to:

- configure observation masks,
- loop over epochs with `gt.Gobs`/`gt.Gsat`,
- export measurement/correction arrays to CSV, and
- compute DOP figures within MATLAB for cross-checking the Python implementation.

## Outputs and diagnostics

The default `Result/` artefacts include:

- `lse_solution.csv` – epoch-by-epoch SPP solution with ECEF, LLH, receiver clock bias, satellite count, and DOP metrics;
- `lse_solution_error_dop.csv` plus `_summary.csv` – numeric error and dilution-of-precision statistics when a truth trajectory is supplied;
- plots (`*_track_2d.png`, `*_track_enu_3d.png`, `*_error_*.png`, `*_error_statistics.png`) visualising the trajectory and residuals; and
- `lse_solution.kml` – Google Earth line strings for both the estimated path and the truth track.

These deliverables mirror the figures submitted for the coursework report and can be regenerated by rerunning the pipeline above.

## Reproducibility tips

- Keep the folder structure unchanged—scripts expect relative paths between `rinex_data`, `Result`, and `ubx-message/data`.
- When adding new rover sessions, duplicate the directory layout for the new dataset so MATLAB/Python paths can be updated with minimal edits.
- Version-control large binary logs with Git LFS if you plan to extend the dataset, and document any new preprocessing steps in this README.